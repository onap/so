<?xml version="1.0" encoding="UTF-8"?>
<bpmn:definitions xmlns:bpmn="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:di="http://www.omg.org/spec/DD/20100524/DI" xmlns:dc="http://www.omg.org/spec/DD/20100524/DC" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" id="Definitions_1" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="1.9.0">
  <bpmn:process id="Process_1" isExecutable="false">
    <bpmn:startEvent id="StartEvent_1" name="Start Flow">
      <bpmn:outgoing>SequenceFlow_1rgq6s6</bpmn:outgoing>
    </bpmn:startEvent>
    <bpmn:scriptTask id="Task_01pfh9q" name="PreProcess Incoming Request" scriptFormat="grovvy">
      <bpmn:incoming>SequenceFlow_1rgq6s6</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1k7t7o4</bpmn:outgoing>
      <bpmn:script><![CDATA[import org.openecomp.mso.bpmn.infrastructure.scripts.*
def csi = new  DoGenericE2EServiceInstanceCreation()
csi.preProcessRequest(execution)]]></bpmn:script>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="SequenceFlow_1rgq6s6" sourceRef="StartEvent_1" targetRef="Task_01pfh9q" />
    <bpmn:scriptTask id="Task_0r1y83e" name="Query the catalog DB Infomation" scriptFormat="groovy">
      <bpmn:incoming>SequenceFlow_1k7t7o4</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1sij9do</bpmn:outgoing>
      <bpmn:script><![CDATA[import org.openecomp.mso.bpmn.infrastructure.scripts.*
def csi = new  DoGenericE2EServiceInstanceCreation()
csi.queryCatalogDB(execution)]]></bpmn:script>
    </bpmn:scriptTask>
    <bpmn:exclusiveGateway id="ExclusiveGateway_1ugz0rd" name="Catalog DB Info is not enough?">
      <bpmn:incoming>SequenceFlow_1sij9do</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0qegoy5</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_1xsyddp</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="SequenceFlow_1k7t7o4" sourceRef="Task_01pfh9q" targetRef="Task_0r1y83e" />
    <bpmn:sequenceFlow id="SequenceFlow_1sij9do" sourceRef="Task_0r1y83e" targetRef="ExclusiveGateway_1ugz0rd" />
    <bpmn:sequenceFlow id="SequenceFlow_0qegoy5" name="No" sourceRef="ExclusiveGateway_1ugz0rd" targetRef="Task_0t427kr">
      <bpmn:conditionExpression xsi:type="bpmn:tFormalExpression" />
    </bpmn:sequenceFlow>
    <bpmn:scriptTask id="Task_0t427kr" name="Query the CSAR From SDC" scriptFormat="groovy">
      <bpmn:incoming>SequenceFlow_0qegoy5</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1k67egc</bpmn:outgoing>
      <bpmn:script><![CDATA[import org.openecomp.mso.bpmn.infrastructure.scripts.*
def csi = new  DoGenericE2EServiceInstanceCreation()
csi.queryCASRFromSDC(execution)]]></bpmn:script>
    </bpmn:scriptTask>
    <bpmn:scriptTask id="Task_16hbwo7" name="Parse the service template" scriptFormat="groovy">
      <bpmn:incoming>SequenceFlow_1k67egc</bpmn:incoming>
      <bpmn:incoming>SequenceFlow_1xsyddp</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_12futmj</bpmn:outgoing>
      <bpmn:script><![CDATA[import org.openecomp.mso.bpmn.infrastructure.scripts.*
def csi = new  DoGenericE2EServiceInstanceCreation()
csi.parserTemplate(execution)]]></bpmn:script>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="SequenceFlow_1k67egc" sourceRef="Task_0t427kr" targetRef="Task_16hbwo7" />
    <bpmn:sequenceFlow id="SequenceFlow_1xsyddp" name="Yes" sourceRef="ExclusiveGateway_1ugz0rd" targetRef="Task_16hbwo7" />
    <bpmn:sequenceFlow id="SequenceFlow_12futmj" sourceRef="Task_16hbwo7" targetRef="ExclusiveGateway_0lzx7fd" />
    <bpmn:scriptTask id="Task_1tx4ujy" name="Decompose the service template" scriptFormat="groovy">
      <bpmn:incoming>SequenceFlow_1gt6ru5</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1av2ctv</bpmn:outgoing>
      <bpmn:script><![CDATA[import org.openecomp.mso.bpmn.infrastructure.scripts.*
def csi = new  DoGenericE2EServiceInstanceCreation()
csi.decomposeService(execution)]]></bpmn:script>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="SequenceFlow_1av2ctv" sourceRef="Task_1tx4ujy" targetRef="Task_0yru3fi" />
    <bpmn:sequenceFlow id="SequenceFlow_1djfh30" sourceRef="Task_0yru3fi" targetRef="Task_15ido6f" />
    <bpmn:scriptTask id="Task_0yru3fi" name="Prepare Put Service Instance to AAI" scriptFormat="groovy">
      <bpmn:incoming>SequenceFlow_1av2ctv</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1djfh30</bpmn:outgoing>
      <bpmn:script><![CDATA[import org.openecomp.mso.bpmn.infrastructure.scripts.*
def csi = new  DoGenericE2EServiceInstanceCreation()
csi.preparesPutServiceInsToAAI(execution)]]></bpmn:script>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="SequenceFlow_0g0luwy" sourceRef="Task_0ctq7by" targetRef="Task_17idicp" />
    <bpmn:scriptTask id="Task_15ido6f" name=" Put Service Instance to AAI" scriptFormat="groovy">
      <bpmn:incoming>SequenceFlow_1djfh30</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0dl9yn6</bpmn:outgoing>
      <bpmn:script><![CDATA[import org.openecomp.mso.bpmn.infrastructure.scripts.*
def csi = new  DoGenericE2EServiceInstanceCreation()
csi.putServiceInsToAAI(execution)]]></bpmn:script>
    </bpmn:scriptTask>
    <bpmn:scriptTask id="Task_0ctq7by" name="Post Process Put Service Instance to AAI" scriptFormat="groovy">
      <bpmn:incoming>SequenceFlow_0vkqn7y</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0g0luwy</bpmn:outgoing>
      <bpmn:script><![CDATA[import org.openecomp.mso.bpmn.infrastructure.scripts.*
def csi = new  DoGenericE2EServiceInstanceCreation()
csi.postPutServiceInsToAAI(execution)]]></bpmn:script>
    </bpmn:scriptTask>
    <bpmn:exclusiveGateway id="ExclusiveGateway_0lzx7fd" name="Success?&#10;&#10;">
      <bpmn:incoming>SequenceFlow_12futmj</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_1gt6ru5</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_083de8i</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="SequenceFlow_1gt6ru5" name="" sourceRef="ExclusiveGateway_0lzx7fd" targetRef="Task_1tx4ujy" />
    <bpmn:sequenceFlow id="SequenceFlow_083de8i" sourceRef="ExclusiveGateway_0lzx7fd" targetRef="EndEvent_0nzsesk" />
    <bpmn:endEvent id="EndEvent_0nzsesk">
      <bpmn:incoming>SequenceFlow_083de8i</bpmn:incoming>
      <bpmn:terminateEventDefinition />
    </bpmn:endEvent>
    <bpmn:scriptTask id="Task_17idicp" name="Update Request DB" scriptFormat="groovy">
      <bpmn:incoming>SequenceFlow_0g0luwy</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_14ru5nc</bpmn:outgoing>
      <bpmn:script><![CDATA[import org.openecomp.mso.bpmn.infrastructure.scripts.*
def csi = new  DoGenericE2EServiceInstanceCreation()
csi.updateRequestDB(execution)]]></bpmn:script>
    </bpmn:scriptTask>
    <bpmn:sequenceFlow id="SequenceFlow_14ru5nc" sourceRef="Task_17idicp" targetRef="EndEvent_1k11fom" />
    <bpmn:exclusiveGateway id="ExclusiveGateway_07hehmp" name="Success?">
      <bpmn:incoming>SequenceFlow_0dl9yn6</bpmn:incoming>
      <bpmn:outgoing>SequenceFlow_0vkqn7y</bpmn:outgoing>
      <bpmn:outgoing>SequenceFlow_0shw5wr</bpmn:outgoing>
    </bpmn:exclusiveGateway>
    <bpmn:sequenceFlow id="SequenceFlow_0dl9yn6" sourceRef="Task_15ido6f" targetRef="ExclusiveGateway_07hehmp" />
    <bpmn:sequenceFlow id="SequenceFlow_0vkqn7y" sourceRef="ExclusiveGateway_07hehmp" targetRef="Task_0ctq7by" />
    <bpmn:endEvent id="EndEvent_12tzgd2">
      <bpmn:incoming>SequenceFlow_0shw5wr</bpmn:incoming>
      <bpmn:terminateEventDefinition />
    </bpmn:endEvent>
    <bpmn:sequenceFlow id="SequenceFlow_0shw5wr" sourceRef="ExclusiveGateway_07hehmp" targetRef="EndEvent_12tzgd2" />
    <bpmn:endEvent id="EndEvent_1k11fom">
      <bpmn:incoming>SequenceFlow_14ru5nc</bpmn:incoming>
      <bpmn:terminateEventDefinition />
    </bpmn:endEvent>
  </bpmn:process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_1">
    <bpmndi:BPMNPlane id="BPMNPlane_1" bpmnElement="Process_1">
      <bpmndi:BPMNShape id="_BPMNShape_StartEvent_2" bpmnElement="StartEvent_1">
        <dc:Bounds x="173" y="102" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="168" y="138" width="49" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ScriptTask_10493ir_di" bpmnElement="Task_01pfh9q">
        <dc:Bounds x="305" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1rgq6s6_di" bpmnElement="SequenceFlow_1rgq6s6">
        <di:waypoint xsi:type="dc:Point" x="209" y="120" />
        <di:waypoint xsi:type="dc:Point" x="305" y="120" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="257" y="99" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ScriptTask_10pmk2i_di" bpmnElement="Task_0r1y83e">
        <dc:Bounds x="468" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_1ugz0rd_di" bpmnElement="ExclusiveGateway_1ugz0rd" isMarkerVisible="true">
        <dc:Bounds x="640" y="95" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="640" y="150" width="49" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1k7t7o4_di" bpmnElement="SequenceFlow_1k7t7o4">
        <di:waypoint xsi:type="dc:Point" x="405" y="120" />
        <di:waypoint xsi:type="dc:Point" x="468" y="120" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="436.5" y="99" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1sij9do_di" bpmnElement="SequenceFlow_1sij9do">
        <di:waypoint xsi:type="dc:Point" x="568" y="120" />
        <di:waypoint xsi:type="dc:Point" x="640" y="120" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="604" y="99" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0qegoy5_di" bpmnElement="SequenceFlow_0qegoy5">
        <di:waypoint xsi:type="dc:Point" x="690" y="120" />
        <di:waypoint xsi:type="dc:Point" x="803" y="120" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="741" y="92" width="14" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ScriptTask_0elmtlr_di" bpmnElement="Task_0t427kr">
        <dc:Bounds x="803" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ScriptTask_0s4bc4e_di" bpmnElement="Task_16hbwo7">
        <dc:Bounds x="1001" y="80" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1k67egc_di" bpmnElement="SequenceFlow_1k67egc">
        <di:waypoint xsi:type="dc:Point" x="903" y="120" />
        <di:waypoint xsi:type="dc:Point" x="1001" y="120" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="952" y="99" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1xsyddp_di" bpmnElement="SequenceFlow_1xsyddp">
        <di:waypoint xsi:type="dc:Point" x="665" y="95" />
        <di:waypoint xsi:type="dc:Point" x="665" y="30" />
        <di:waypoint xsi:type="dc:Point" x="1051" y="30" />
        <di:waypoint xsi:type="dc:Point" x="1051" y="80" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="844" y="33" width="18" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_12futmj_di" bpmnElement="SequenceFlow_12futmj">
        <di:waypoint xsi:type="dc:Point" x="1051" y="160" />
        <di:waypoint xsi:type="dc:Point" x="1051" y="291" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1066" y="219.5" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ScriptTask_00nixv6_di" bpmnElement="Task_1tx4ujy">
        <dc:Bounds x="1001" y="412" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1av2ctv_di" bpmnElement="SequenceFlow_1av2ctv">
        <di:waypoint xsi:type="dc:Point" x="1001" y="452" />
        <di:waypoint xsi:type="dc:Point" x="903" y="452" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="952" y="431" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_1djfh30_di" bpmnElement="SequenceFlow_1djfh30">
        <di:waypoint xsi:type="dc:Point" x="803" y="452" />
        <di:waypoint xsi:type="dc:Point" x="752" y="452" />
        <di:waypoint xsi:type="dc:Point" x="752" y="452" />
        <di:waypoint xsi:type="dc:Point" x="715" y="452" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="767" y="446" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ScriptTask_1s0zjq1_di" bpmnElement="Task_0yru3fi">
        <dc:Bounds x="803" y="412" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0g0luwy_di" bpmnElement="SequenceFlow_0g0luwy">
        <di:waypoint xsi:type="dc:Point" x="305" y="452" />
        <di:waypoint xsi:type="dc:Point" x="241" y="452" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="273" y="431" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ScriptTask_0sx00s8_di" bpmnElement="Task_15ido6f">
        <dc:Bounds x="615" y="412" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ScriptTask_03c6329_di" bpmnElement="Task_0ctq7by">
        <dc:Bounds x="305" y="412" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ExclusiveGateway_0lzx7fd_di" bpmnElement="ExclusiveGateway_0lzx7fd" isMarkerVisible="true">
        <dc:Bounds x="1026" y="291" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="972" y="309" width="49" height="36" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_1gt6ru5_di" bpmnElement="SequenceFlow_1gt6ru5">
        <di:waypoint xsi:type="dc:Point" x="1051" y="341" />
        <di:waypoint xsi:type="dc:Point" x="1051" y="412" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1061.5" y="364.5" width="49" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_083de8i_di" bpmnElement="SequenceFlow_083de8i">
        <di:waypoint xsi:type="dc:Point" x="1076" y="316" />
        <di:waypoint xsi:type="dc:Point" x="1171" y="316" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1123.5" y="295" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="EndEvent_1kp1h6k_di" bpmnElement="EndEvent_0nzsesk">
        <dc:Bounds x="1171" y="298" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="1188.042" y="338" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="ScriptTask_1m4zxpa_di" bpmnElement="Task_17idicp">
        <dc:Bounds x="141" y="412" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_14ru5nc_di" bpmnElement="SequenceFlow_14ru5nc">
        <di:waypoint xsi:type="dc:Point" x="191" y="492" />
        <di:waypoint xsi:type="dc:Point" x="191" y="518" />
        <di:waypoint xsi:type="dc:Point" x="191" y="518" />
        <di:waypoint xsi:type="dc:Point" x="191" y="563" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="161" y="512" width="90" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="ExclusiveGateway_07hehmp_di" bpmnElement="ExclusiveGateway_07hehmp" isMarkerVisible="true">
        <dc:Bounds x="493" y="427" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="493" y="401" width="49" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0dl9yn6_di" bpmnElement="SequenceFlow_0dl9yn6">
        <di:waypoint xsi:type="dc:Point" x="615" y="452" />
        <di:waypoint xsi:type="dc:Point" x="543" y="452" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="579" y="431" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="SequenceFlow_0vkqn7y_di" bpmnElement="SequenceFlow_0vkqn7y">
        <di:waypoint xsi:type="dc:Point" x="493" y="452" />
        <di:waypoint xsi:type="dc:Point" x="405" y="452" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="449" y="431" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="EndEvent_195rk4w_di" bpmnElement="EndEvent_12tzgd2">
        <dc:Bounds x="500" y="563" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="518" y="602.721" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="SequenceFlow_0shw5wr_di" bpmnElement="SequenceFlow_0shw5wr">
        <di:waypoint xsi:type="dc:Point" x="518" y="477" />
        <di:waypoint xsi:type="dc:Point" x="518" y="563" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="533" y="514" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="EndEvent_1cxhx33_di" bpmnElement="EndEvent_1k11fom">
        <dc:Bounds x="173" y="563" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <dc:Bounds x="146" y="603" width="0" height="12" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</bpmn:definitions>
